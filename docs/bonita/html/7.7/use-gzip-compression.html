<div style="position: relative;"><a href="https://github.com/bonitasoft/bonita-doc/edit/7.7/md/use-gzip-compression.md"><img style="position: absolute; top: -1px; right: -40px; border: 0; z-index=-100;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a></div>
<h1>Use gzip compression</h1>
<p>How to activate gzip compression for a Bonita Platform with Tomcat and with WildFly. It can improve performance by reducing network load.</p>
<h2>WildFly</h2>
<p>To activate compression for WildFly, you need to modify the <code>standalone.xml</code> configuration.</p>
<p>Therefore, in your Wildfly bundle, you need to open <code>WILDFLY_HOME/setup/wildfly-templates/standalone.xml</code> and find the <code>undertow:3.1</code> subsystem. Edit the section to add the following filters as shown below:</p>
<pre><code class="language-xml">        &lt;subsystem xmlns=&quot;urn:jboss:domain:undertow:3.1&quot;&gt;
            &lt;buffer-cache name=&quot;default&quot; /&gt;
            &lt;server name=&quot;default-server&quot;&gt;
                &lt;http-listener name=&quot;default&quot; socket-binding=&quot;http&quot; redirect-socket=&quot;https&quot; enable-http2=&quot;true&quot; max-post-size=&quot;104857600&quot; /&gt;
                &lt;https-listener name=&quot;https&quot; socket-binding=&quot;https&quot; security-realm=&quot;ApplicationRealm&quot; enable-http2=&quot;true&quot; /&gt;
                &lt;host name=&quot;default-host&quot; alias=&quot;localhost&quot;&gt;
                    &lt;location name=&quot;/&quot; handler=&quot;welcome-content&quot; /&gt;
                    &lt;!-- ##################### GZIP COMPRESSION ################# --&gt;
                    &lt;filter-ref name=&quot;server-header&quot;/&gt;
                    &lt;filter-ref name=&quot;x-powered-by-header&quot;/&gt;
                    &lt;filter-ref name=&quot;gzipFilter&quot; predicate=&quot;exists['%{o,Content-Type}'] and regex[pattern='(?:application/javascript|text/css|text/html|text/xml|application/json)(;.*)?', value=%{o,Content-Type}, full-match=true]&quot;/&gt;
                    &lt;filter-ref name=&quot;Vary-header&quot;/&gt;
                    &lt;!-- ######################################################## --&gt;
                &lt;/host&gt;
            &lt;/server&gt;
            &lt;servlet-container name=&quot;default&quot;&gt;
                &lt;jsp-config /&gt;
                &lt;websockets /&gt;
                &lt;session-cookie name=&quot;SESSIONID&quot; /&gt;
            &lt;/servlet-container&gt;
            &lt;handlers&gt;
                &lt;file name=&quot;welcome-content&quot; path=&quot;${jboss.home.dir}/welcome-content&quot; /&gt;
            &lt;/handlers&gt;
            &lt;!-- #################### GZIP COMPRESSION ################### --&gt;
            &lt;filters&gt;
                &lt;response-header name=&quot;server-header&quot; header-name=&quot;Server&quot; header-value=&quot;WildFly/10&quot;/&gt;
                &lt;response-header name=&quot;x-powered-by-header&quot; header-name=&quot;X-Powered-By&quot; header-value=&quot;Undertow/1&quot;/&gt;
                &lt;response-header name=&quot;Vary-header&quot; header-name=&quot;Vary&quot; header-value=&quot;Accept-Encoding&quot;/&gt;
                &lt;gzip name=&quot;gzipFilter&quot;/&gt;
            &lt;/filters&gt;
            &lt;!-- ######################################################### --&gt;
        &lt;/subsystem&gt;
</code></pre>
<h2>Tomcat</h2>
<p>To activate gzip compression for http requests, you need to modify the <code>server.xml</code> configuration.</p>
<p>Open <code>server.xml</code> and find the Connector configuration that you use. Edit the section to add following parameters:</p>
<pre><code class="language-xml">compression=&quot;on&quot;
compressionMinSize=&quot;X&quot;
noCompressionUserAgents=&quot;Y&quot;
compressableMimeType=&quot;Z&quot;
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">Property</th>
<th style="text-align:left">Description</th>
<th style="text-align:left">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">compression</td>
<td style="text-align:left">Activates or deactivates gzip compression.</td>
<td style="text-align:left">on</td>
</tr>
<tr>
<td style="text-align:left">compressionMinSize</td>
<td style="text-align:left">The minimum size of resources to be compressed. It is not useful to compress resources that are already small.</td>
<td style="text-align:left">2048</td>
</tr>
<tr>
<td style="text-align:left">noCompressionUserAgents</td>
<td style="text-align:left">The User Agents for which compressions is not to be used. Some older browseers do not support compression.</td>
<td style="text-align:left">gozilla, traviata</td>
</tr>
<tr>
<td style="text-align:left">compressableMimeType</td>
<td style="text-align:left">The MIME types of the resources to be compressed. We recommend that all text files be compressed.</td>
<td style="text-align:left">text/html,text/xml</td>
</tr>
</tbody>
</table>
<p>If you use the Tomcat bundle, the file to edit is <code>TOMCAT_HOME/server/conf/server.xml</code>.
If you use a different package, use the corresponding path; for example on Ubuntu the file is located in <code>/etc/tomcat8/server.xml</code>.</p>
<p>Connector configuration:</p>
<pre><code class="language-xml">&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;
   connectionTimeout=&quot;20000&quot;
   redirectPort=&quot;8443&quot;
   maxPostSize=&quot;-1&quot;
   URIEncoding=&quot;UTF-8&quot;
   compression=&quot;on&quot;
   compressionMinSize=&quot;2048&quot;
   noCompressionUserAgents=&quot;gozilla, traviata&quot;
   compressableMimeType=&quot;text/html,text/xml,text/plain,text/javascript,text/css&quot;&gt;&lt;/Connector&gt;
</code></pre>
<h2>Check changes</h2>
<p>After you modify the file, restart your application server and test with the following <code>curl</code> command:
<code>curl -I -H 'Accept-Encoding: gzip' http://</code><em><code>ip_address:port</code></em><code>/bonita/login.jsp</code></p>
<p>Check that the header returned contains the line <code>Content-Encoding: gzip</code>. For example, on a WildFly system the output will be similar to this:</p>
<pre><code>HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Expires: 0
Cache-Control: no-store, no-cache, must-revalidate, proxy-revalidate
Pragma: no-cache
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-Powered-By: JSP/2.2
Content-Type: text/html;charset=UTF-8
Transfer-Encoding: chunked
Content-Encoding: gzip
Vary: Accept-Encoding
</code></pre>
<!-- Generated on Wed Dec 04 2019 13:25:31 GMT+0100 (Paris, Madrid) -->