<div style="position: relative;"><a href="https://github.com/bonitasoft/bonita-doc/edit/7.7/md/bonita-as-windows-service.md"><img style="position: absolute; top: -1px; right: -40px; border: 0; z-index=-100;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a></div>
<h1>How to install Bonita as a service on Windows</h1>
<p>In this tutorial we show how to install Tomcat with Bonita configured as a windows service.</p>
<h2>Software needed</h2>
<p>For this tutorial you will need the following softwares:</p>
<ul>
<li>Tomcat</li>
<li>Bonita deploy Bundle</li>
<li>Postgresql Database (or another database supported by Bonita)</li>
</ul>
<p>Please verify the supported version from the Support page</p>
<h2>Download and installation</h2>
<ul>
<li><strong><em>Download</em></strong> apache-tomcat-x.y.exe from Tomcat website: https://tomcat.apache.org/</li>
<li><strong><em>Install</em></strong> apache-tomcat-x.y.exe. From now on we'll call the installation path as %TOMCAT_INSTALL_FOLDER%</li>
<li><strong><em>Verify</em></strong> that Tomcat is well installed browsing the following URL: http://localhost:8080</li>
</ul>
<p><img src="bonita/images/7.7/bonita-as-windows-service/tomcatHome.png" alt="Tomcat home page" title="Tomcat home page"></p>
<ul>
<li><strong><em>Download</em></strong> the bundle BonitaSubscription-x.y.z-deploy.zip (or BonitaCommunity-x.y.z-deploy.zip for the community edition)</li>
<li><strong><em>Unzip</em></strong> the bundle in a folder that we'll call: %BONITA_DEPLOY%</li>
<li><strong><em>Move</em></strong> the setup tool %BONITA_DEPLOY%/setup into another folder, for example %TOMCAT_INSTALL_FOLDER%/setup
This last step is not mandatory since the setup tool is independent from Tomcat, you can place it wherever you want.</li>
</ul>
<h2>Get the license (In case of Subscription edition)</h2>
<ul>
<li><strong><em>Execute</em></strong> %BONITA_DEPLOY%/request_key_utils/generateRequestKey.bat</li>
<li><strong><em>Use</em></strong> the generated key to get a license from the customer portal. The license shouldn't be a development license.</li>
<li><strong><em>Move</em></strong> the license file into the folder %TOMCAT_INSTALL_FOLDER%/setup/platform_conf/licenses</li>
</ul>
<h2>Database configuration</h2>
<ul>
<li><strong><em>Configure</em></strong> the file %TOMCAT_INSTALL_FOLDER%/setup/database.properties to point towards the suited database (engine and BDM)</li>
</ul>
<p><img src="bonita/images/7.7/bonita-as-windows-service/databaseProperties.png" alt="database-properties file" title="database-properties file"></p>
<ul>
<li><strong><em>Add</em></strong> the database driver here: %TOMCAT_INSTALL_FOLDER%/setup/lib
Check your Database provider documentation in order to get the proper driver version.</li>
<li><strong><em>Execute</em></strong> the command &quot;%TOMCAT_INSTALL_FOLDER%/setup/setup.bat init&quot; in order to initialize the Bonita database with the default configuration.</li>
<li><strong><em>Verify</em></strong> that the tables in the engine database are properly created.</li>
</ul>
<p><img src="bonita/images/7.7/bonita-as-windows-service/postgresTables.png" alt="database tables" title="database tables"></p>
<h2>Server configuration</h2>
<ul>
<li><strong><em>Move</em></strong> the folder %BONITA_DEPLOY%/Tomcat-x.y.z/server/lib to %TOMCAT_INSTALL_FOLDER%/lib</li>
<li><strong><em>Add</em></strong> your database driver to %TOMCAT_INSTALL_FOLDER%/lib</li>
<li><strong><em>Move</em></strong> the folder %BONITA_DEPLOY%/Tomcat-x.y.z/server/conf to %TOMCAT_INSTALL_FOLDER%/conf</li>
<li><strong><em>Move</em></strong> the folder %BONITA_DEPLOY%/Tomcat-x.y.z/server/webapps to %TOMCAT_INSTALL_FOLDER%/webapps</li>
<li><strong><em>Configure</em></strong> %TOMCAT_INSTALL_FOLDER%/conf/bitronix-resources.properties</li>
</ul>
<p><img src="bonita/images/7.7/bonita-as-windows-service/bitronixConfiguration.png" alt="bitronix configuration" title="bitronix configuration"></p>
<ul>
<li><strong><em>Configure</em></strong> %TOMCAT_INSTALL_FOLDER%/conf/Catalina/localhost/bonita.xml</li>
</ul>
<p><img src="bonita/images/7.7/bonita-as-windows-service/bonitaXml.png" alt="datasource configuration" title="datasource configuration"></p>
<h2>Configure JVM properties</h2>
<ul>
<li>
<p>The file %BONITA_DEPLOY%/Tomcat-x.y.z/server/bin/setenv.bat contains all JVM parameters to use in the new installation.</p>
</li>
<li>
<p>Update this file to change the database provider (for example postgresql).</p>
</li>
<li>
<p>In this file update all the references to %CATALINA_HOME% with %TOMCAT_INSTALL_FOLDER%
In this example %TOMCAT_INSTALL_FOLDER% = C:\Program Files\Apache Software Foundation\Tomcat x.y</p>
</li>
<li>
<p>Extract all the JVM properties of the file %BONITA_DEPLOY%/Tomcat-x.y.z/server/bin/setenv.bat</p>
</li>
<li>
<p>The properties should be the following ones:</p>
<ul>
<li>-Dorg.bonitasoft.platform.setup.folder=C:\Program Files\Apache Software Foundation\Tomcat x.y\setup</li>
<li>-Dorg.bonitasoft.engine.incident.folder=C:\Program Files\Apache Software Foundation\Tomcat x.y\logs</li>
<li>-Dsysprop.bonita.db.vendor=postgres</li>
<li>-Dsysprop.bonita.bdm.db.vendor=postgres</li>
<li>-Dbtm.root=C:\Program Files\Apache Software Foundation\Tomcat x.y</li>
<li>-Dbitronix.tm.configuration=C:\Program Files\Apache Software Foundation\Tomcat x.y\conf\bitronix-config.properties</li>
<li>-Dfile.encoding=UTF-8</li>
</ul>
</li>
</ul>
<p>All these configurations should be realized in the file %TOMCAT_INSTALL_FOLDER%/bin/TomcatXw.exe (Where X is the Tomcat major version), more precisely in the java tab.</p>
<p><img src="bonita/images/7.7/bonita-as-windows-service/tomcatw.png" alt="tomcatw configuration" title="tomcatw configuration"></p>
<ul>
<li>
<p>Setup %TOMCAT_INSTALL_FOLDER%/bin/Tomcat8w.exe -&gt; Java -&gt; &quot;Initial memory&quot; with a proper value based on your hardware and project requirements.</p>
</li>
<li>
<p>Do the same with &quot;Maximum Memory pool&quot; property.
As an example, if your Operating system has 8 GB of ram you could setup Initial Memory Pool = Maximum Memory Pool = 4096.</p>
</li>
<li>
<p>Verify that in the Startup tab the &quot;Mode&quot; property is set to &quot;Jvm&quot;.</p>
</li>
</ul>
<p><img src="bonita/images/7.7/bonita-as-windows-service/tomcatWStartup.png" alt="tomcatw startup tab" title="tomcatw startup tab"></p>
<h2>System restart and test</h2>
<ul>
<li>
<p>Restart the Tomcat service to take in account the new updates.</p>
</li>
<li>
<p>Verify that the Bonita portal is available at the following address:
http://localhost:8080/bonita</p>
</li>
<li>
<p>Connect with the technical user (default install/install) and do some tests:</p>
<ul>
<li>Add an organization.</li>
<li>Assign profiles to users.</li>
<li>Deploy a simple process and test its execution.</li>
</ul>
</li>
</ul>
<!-- Generated on Wed Dec 04 2019 13:25:31 GMT+0100 (Paris, Madrid) -->