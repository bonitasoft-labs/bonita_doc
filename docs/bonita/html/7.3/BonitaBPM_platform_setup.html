<div style="position: relative;"><img style="position: absolute; top: -1px; right: -40px; border: 0; z-index=-100;" src="bonita/images/7.3/outOfSupport.png" alt="Out of support"></div>
<h1>Platform configuration</h1>
<p>In this section you will learn what the Platform setup tool is and how to use it to initialize and configure the Bonita BPM Platform.</p>
<a id="platform_setup_tool" />
<h2>Platform setup tool overview</h2>
<p>The <em>Platform setup tool</em> handles the creation of the database schema and the configuration of Bonita BPM Platform.<br>
It is located in the <a href="?page=deploy-bundle" ng-click="contentCtrl.goTo($event, 'deploy-bundle')">deploy bundle</a> and in both <a href="?page=tomcat-bundle" ng-click="contentCtrl.goTo($event, 'tomcat-bundle')">Tomcat</a> and <a href="?page=jboss-bundle" ng-click="contentCtrl.goTo($event, 'jboss-bundle')">JBoss</a> bundles.</p>
<div class="alert alert-info" role="alert">
<p>In Tomcat and JBoss bundles you can find the tool in the <code>setup</code> folder</p>
</div>
<h3>Structure</h3>
<p>It is composed of the following items:</p>
<ul>
<li><code>platform_conf/</code>
<ul>
<li><code>initial/</code>: contains the default configuration of the Bonita BPM Platform, that can be customized and will be pushed when the database is created.</li>
<li><code>current/</code>: will contain configuration files after a <code>pull</code> from the database is made.</li>
<li><code>licenses/</code>: (Subscriptions only) ⇒ must contain the license file to allow Bonita BPM Platform to start without error.</li>
<li><code>sql/</code>: SQL scripts that are used to create the Bonita BPM database tables</li>
</ul>
</li>
<li><code>setup.sh</code>: Unix / Mac script to run.</li>
<li><code>setup.bat</code>: Windows script to run.</li>
<li><code>database.properties</code>: contains properties to connect to the database on which the configuration is managed.</li>
</ul>
<h3>Functions</h3>
<p>This tool has 3 functions:</p>
<ul>
<li>
<p>Initialize the database:<code>init</code>
It creates the database schema and pushes the initial configuration in the database.<br>
This initial configuration is taken from the <code>platform_conf/initial</code> folder.</p>
</li>
<li>
<p>Retrieve current configuration: <code>pull</code>
It gets the current configuration of Bonita BPM Platform and saves it in the <code>platform_conf/current</code> folder.</p>
</li>
<li>
<p>Update current configuration: <code>push</code>
It pushes the configuration from the <code>platform_conf/current</code> folder into the database of an already initialized Bonita BPM Platform</p>
</li>
</ul>
<a id="configure_tool" />
<h2>Configure the Platform setup tool</h2>
<p>Before running it, the tool must be configured to point to the database of the Bonita BPM Platform.</p>
<p>To do so, after you have created the database, modify the tool <code>database.properties</code> file:<br>
Set the right db vendor by commenting and uncommenting properties inside this file and change connection url, user credentials, database name and so on.</p>
<p>If you are using an Oracle or Microsoft SQL Server database, you will need to add the related JDBC driver in the <code>lib</code> folder.</p>
<div class="alert alert-warning" role="alert">
<p>This database configuration is only for the Platform setup tool. You still need to configure the database for your Tomcat or JBoss bundle.<br>
To do so, refer to the <a href="?page=tomcat-bundle" ng-click="contentCtrl.goTo($event, 'tomcat-bundle')" class="alert-link">Tomcat</a> and <a href="?page=jboss-bundle" ng-click="contentCtrl.goTo($event, 'jboss-bundle')" class="alert-link">JBoss</a> bundles pages.</p>
</div>
<a id="init_platform_conf" />
<h2>Initialize Bonita BPM Platform</h2>
<p>You can initialize Bonita BPM Platform manually on an empty database using the <em>Platform setup tool</em>.</p>
<div class="alert alert-info" role="alert">
<p>Remember that in the <a href="?page=tomcat-bundle" ng-click="contentCtrl.goTo($event, 'tomcat-bundle')" class="alert-link">Tomcat</a> and <a href="?page=jboss-bundle" ng-click="contentCtrl.goTo($event, 'jboss-bundle')" class="alert-link">JBoss</a> bundles, this is done automatically.</p>
</div>
<p>To do so, proceed as follows:</p>
<ol>
<li>Create a new empty database.</li>
<li>Configure the <em>Platform setup tool</em> as explained above.</li>
<li>From the tool, run <code>setup.sh init</code> (Unix/Mac) or <code>setup.bat init</code> (Windows).</li>
</ol>
<p>This last step will connect to the database pointed to in <code>database.properties</code>, create the tables required for the platform to run, push all configuration from the <code>platform_conf/initial</code> folder and push the licenses from the licenses folder.</p>
<p>That's it! You can now run Bonita BPM Platform on this database.</p>
<a id="update_platform_conf" />
<h2>Update Bonita BPM Platform configuration or licenses</h2>
<p>If you want to modify the configuration of an already initialized Bonita BPM Platform, you must use the <em>Platform setup tool</em> as follows:</p>
<ol>
<li>Stop Bonita BPM Platform.</li>
<li>If not already done, update the <code>database.properties</code> of the <em>Platform setup tool</em> to point to the database used by Bonita BPM Platform.</li>
<li>Run <code>setup.sh pull</code> or <code>setup.bat pull</code> from the tool. It will get the current configuration and put it in the <code>platform_conf/current</code> folder.</li>
<li>Modify the configuration files inside the <code>platform_conf/current</code> folder according to your needs.</li>
<li>If you are updating your license file, put it inside <code>platform_conf/licenses</code>, along with the existing ones. If some retrieved license files are not valid anymore, you can remove them, to delete them from the database when pushed.</li>
<li>Run <code>setup.sh push</code> or <code>setup.bat push</code> from the tool.</li>
<li>Start Bonita BPM Platform.</li>
</ol>
<div class="alert alert-info" role="alert">
<p>Note that the <em>Platform Setup tool</em> does not need the Bonita BPM Server to be running for the configuration to be updated. However, the server needs to be restarted for the changes to take effect.</p>
</div>
<div class="alert alert-warning" role="alert">
<p>Keep in mind that the folder <strong><code>platform_conf/initial</code></strong> is not used anymore once the platform has been initialized for the first time. To update your configuration, only the <strong><code>platform_conf/current</code></strong> folder is taken into account.</p>
</div>
<h2>Troubleshooting</h2>
<hr>
<p><strong>Problem</strong>: When I run Platform setup tool, I get the exception: <code>locked by an other process</code></p>
<p><strong>Possible cause</strong>: The Platform setup tool tries to access the same database (H2) as a running Bonita BPM Bundle or Bonita BPM Studio.</p>
<p><strong>Solution</strong>: Stop Bundle or Studio before running Platform setup tool, as H2 tends to lock the database files when running.</p>
<hr>
<p><strong>Problem</strong>: When I run Platform setup tool, I get the exception <code>Cannot determine database vendor (valid values are h2, postgres, sqlserver, oracle, mysql).</code></p>
<p><strong>Possible cause</strong>: property <code>db.vendor</code> is not found when reading file <code>database.properties</code></p>
<p><strong>Solution</strong>: Edit file <code>database.properties</code> and ensure there is a valid <code>db.vendor</code> value. Also ensure the line is not commented (no # at the beginning of the line)</p>
<hr>
<!-- Generated on Tue Jun 19 2018 09:27:07 GMT+0200 (Paris, Madrid (heure d’été)) -->