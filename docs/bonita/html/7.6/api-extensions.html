<div style="position: relative;"><a href="https://github.com/bonitasoft/bonita-doc/edit/7.6/md/api-extensions.md"><img style="position: absolute; top: -1px; right: -40px; border: 0; z-index=-100;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a></div>
<h1>REST API extensions</h1>
<p>A REST API extension is a way to add extra REST resources using Bonita. REST API extensions are <a href="?page=resource-management" ng-click="contentCtrl.goTo($event, 'resource-management')">exported, imported, updated, and deleted</a> as resources in Bonita Portal.</p>
<p>If you want to learn how to create REST API extension, refer to the documentation page about Bonita Studio <a href="?page=rest-api-extensions" ng-click="contentCtrl.goTo($event, 'rest-api-extensions')">tooling for creating and testing REST API extensions</a> (for Bonita subscription edition).</p>
<p>Page below contains information about deploying a REST API manually, which is possible with all editions.</p>
<h2>Deploy a REST API extension</h2>
<p>You need to deploy the REST API zip archive using Bonita Portal:</p>
<ol>
<li>Connect to the Bonita Portal and switch to &quot;administrator&quot; view.</li>
<li>Go to Resources. You will see the list of all resources, and a filter for each type of resource (Pages, Forms, Layouts, Themes and API extensions).</li>
<li>Click Add button (top left).</li>
<li>Click in the Archive field, then select the REST API extension zip file.</li>
<li>Click Next.</li>
<li>Click Confirm. The resource is added to the portal</li>
</ol>
<p>REST API extensions use the same authorization mechanism as the standard Bonita REST APIs. When you import the extension, the information in <code>page.properties</code> is used to create the appropriate resource permission mappings in Bonita (see <a href="?page=rest-api-authorization" ng-click="contentCtrl.goTo($event, 'rest-api-authorization')">REST API authorization</a> for information about REST API security configuration).</p>
<div class="alert alert-info" role="alert">
<p><strong>Note</strong>: It is also possible to deploy a REST API extension using <a href="?hash=page&amp;page=portal-api" ng-click="contentCtrl.goTo($event, 'portal-api', 'page')" class="alert-link">REST portal API / &quot;page&quot; resource</a>.</p>
</div>
<div class="alert alert-info" role="alert">
<p><strong>Note</strong>: The deployment of the REST API extensions should always be made from the portal or its APIs, not directly from Engine APIs. Notably, the createPage() method of the Engine PageAPI would alllow you to deploy a REST API extension, but would not update the security settings, meaning that you would not be able to access it at runtime.</p>
</div>
<div class="alert alert-warning" role="alert">
<p><strong>Warning</strong>: If you are running Bonita in a cluster, after you import a REST API extension, you must restart the application server on all the cluster nodes.</p>
</div>
<a id="usage"/>
<h2>Usage</h2>
<p>A REST API extension must be deployed before any page or form resource using it is deployed.</p>
<p>A page that uses REST API extensions must add the required resources in the page resource <code>page.properties</code> file.
For example, if a page uses the demoHeaders, demoXml, and putResource API extensions, its <code>page.properties</code> must include this line:</p>
<pre><code>resources=[GET|extension/demoHeaders,POST|extension/demoXml,PUT|extension/putResource]
</code></pre>
<p>If the page declares its resources correctly, then every user being able to access this page (because it is part of a custom profile or Living Application they have access to)
will also be automatically granted the necessary permissions to call the REST API extension. This works the same way as with the other resources of the REST API.<br>
However, if you need to grant access to this API extension to some users regardless of the pages they have access to, then you need to add <a href="?hash=custom-permissions-mapping&amp;page=rest-api-authorization" ng-click="contentCtrl.goTo($event, 'rest-api-authorization', 'custom-permissions-mapping')">custom permissions</a> for these users.<br>
In order to do so, edit <code>custom-permissions-mapping.properties</code> to give the permissions (value of the property <code>apiExtension.permissions</code>) declared in the page.properties of the REST API extension to the required profiles or users.</p>
<div class="alert alert-info" role="alert">
<p><strong>Note</strong>: REST API permissions are stored in the user's session and new permissions will only be effective for a user the next time he logs in to the portal.</p>
</div>
<h2>REST API extension examples</h2>
<p>A REST API extension example resource and API extension viewer page are provided in administrator portal. They are located in administrator portal.</p>
<p>To use the examples, define a <a href="?hash=custom-permissions-mapping&amp;page=rest-api-authorization" ng-click="contentCtrl.goTo($event, 'rest-api-authorization', 'custom-permissions-mapping')">custom permissions</a> mapping for <code>demoPermission</code>:</p>
<ul>
<li>Retrieve platform configuration using the <a href="?hash=update_platform_conf&amp;page=BonitaBPM_platform_setup" ng-click="contentCtrl.goTo($event, 'BonitaBPM_platform_setup', 'update_platform_conf')">setup tool</a>.</li>
<li>Edit <code>platform_conf/current/tenants/&lt;TENANT_ID&gt;/tenant_portal/custom-permissions-mapping.properties</code>.</li>
<li>Add the following line: <code>profile|User=[demoPermission]</code>.</li>
<li>Push the changed platform configuration into database using the <em>setup tool</em>.</li>
<li>Restart Tomcat bundle</li>
</ul>
<p>REST API extension examples show how to:</p>
<ul>
<li>Customize response with additional header, cookie and response code</li>
<li>Get resource return a simple echo of query parameters</li>
<li>Use a SLF4J logger</li>
<li>Post resources with Json payload and return a simple echo of parameters</li>
<li>Return an XML content with specific media type and character set</li>
<li>Call to external SOAP webservice (requires internet connexion)</li>
</ul>
<p>Another REST API extension example with SQL data source is available on <a href="http://community.bonitasoft.com/project/data-source-rest-api-extension">Bonitasoft Community</a>. This example show how to execute SQL queries on a external database.</p>
<!-- Generated on Fri Jan 19 2018 16:08:26 GMT+0100 (Paris, Madrid) -->