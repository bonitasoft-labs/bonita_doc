<div style="position: relative;"><a href="https://github.com/bonitasoft/bonita-continuous-delivery-doc/edit/1.1/md/quickstart.md"><img style="position: absolute; top: -1px; right: -40px; border: 0; z-index=-100;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"/></a></div>
<h1>Bonita Continuous Delivery Quick Start</h1>
<p>Bonita Continuous Delivery (BCD) solution is provided as a <code>bonita-continuous-delivery_&lt;version&gt;.tar.gz</code> archive.</p>
<p>This page describes how to use this archive to quickly start using Bonita Continuous Delivery solution.</p>
<h2>Prepare your workstation</h2>
<h3>Step-by-step installation</h3>
<p>In order to ease your environment setup, we provide a <a href="https://docs.docker.com/">Docker</a> image which contains all required dependencies and tools for the <strong>Control Machine</strong> (ie. the machine from which Bonita Continuous Delivery commands are launched).</p>
<p>Follow these installation steps on your workstation.</p>
<ol>
<li>
<p>Make sure Docker is installed as described in the <a href="https://docs.docker.com/engine/installation/">Install Docker</a> documentation.</p>
</li>
<li>
<p>Extract the <code>bonita-continuous-delivery_&lt;version&gt;.tar.gz</code> archive:</p>
<pre><code>$ tar xzf bonita-continuous-delivery_&lt;version&gt;.tar.gz
</code></pre>
<p>This step creates a <code>bonita-continuous-delivery_&lt;version&gt;</code> directory which contains:</p>
<ul>
<li>Bonita Continuous Delivery Ansible playbooks and roles.</li>
<li>A pre-built Docker image for the Control Machine. This Docker image is provided as a <code>bcd-controller_&lt;version&gt;.tar.gz</code> archive located in the <code>bonita-continuous-delivery_&lt;version&gt;/docker</code> directory.</li>
</ul>
</li>
<li>
<p>Load the <code>bcd-controller_&lt;version&gt;.tar.gz</code> Docker image:</p>
<pre><code>$ cd bonita-continuous-delivery_&lt;version&gt;/docker
$ gunzip -c bcd-controller_&lt;version&gt;.tar.gz | docker load
Loaded image: bonitasoft/bcd-controller:&lt;version&gt;
Loaded image: bonitasoft/bcd-controller:latest
</code></pre>
<p>The <code>bonitasoft/bcd-controller</code> Docker image is now available. To use the image, it is recommended to prepare the following local files which will be shared as Docker volumes in the next step:</p>
<ul>
<li><strong><code>.boto</code></strong> (mounted as <code>/home/bonita/.boto</code>) - The <a href="https://boto.readthedocs.io/en/latest/boto_config_tut.html"><code>.boto</code></a> file contains AWS credentials used to make programmatic calls to AWS. The content of a <code>.boto</code> file is as follows:<pre><code class="language-ini">[Credentials]
aws_access_key_id = &lt;YOUR_AWS_ACCESS_KEY&gt;
aws_secret_access_key = &lt;YOUR_AWS_SECRET_ACCESS_KEY&gt;
</code></pre>
</li>
<li><strong><code>ssh_private_key</code></strong> (mounted as <code>/home/bonita/.ssh/ssh_private_key</code>) - The <code>ssh_private_key</code> file is the SSH private key used to connect to your target machines. For AWS, this is the private part of your <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html">EC2 key pair</a>. This file should only be accessible from your user (<code>chmod 600 ~/.ssh/ssh_private_key</code>).</li>
<li><strong><code>/local/path/to/bonita-continuous-delivery_&lt;version&gt;</code></strong> (mounted as <code>/home/bonita/bonita-continuous-delivery</code>) - The provided <code>bonita-continuous-delivery</code> directory contains Ansible playbooks for Bonita Continuous Delivery.</li>
</ul>
</li>
<li>
<p>Start a Docker container for the Control Machine:</p>
<pre><code>$ docker run --rm -ti --hostname control_machine --name bcd-controller \
    -v &lt;local_path_to_.boto_file&gt;:/home/bonita/.boto \
    -v &lt;local_path_to_bonita-continuous-delivery_directory&gt;:/home/bonita/bonita-continuous-delivery \
    -v &lt;local_path_to_ssh_private_key_file&gt;:/home/bonita/.ssh/&lt;ssh_private_key&gt; \
    bonitasoft/bcd-controller /bin/bash
</code></pre>
</li>
</ol>
<h3>Complete installation example</h3>
<p>Here is a complete example of how to install the Control Machine Docker image for Bonita Continuous Delivery.</p>
<p><strong>Warning</strong>: This example uses <em>fake</em> AWS credentials and SSH private key... :-)</p>
<p>Assuming you have a <code>bonita-continuous-delivery_1.0.0.tar.gz</code> archive in your <code>$HOME</code> directory:</p>
<pre><code>$ cd $HOME
$ tar xzf bonita-continuous-delivery_1.0.0.tar.gz

$ cd bonita-continuous-delivery_1.0.0/docker

$ gunzip -c bcd-controller_1.0.0.tar.gz | docker load
[...]
Loaded image: bonitasoft/bcd-controller:1.0.0
Loaded image: bonitasoft/bcd-controller:latest

$ cd $HOME

$ ls -nh
total 418M
drwxrwxr-x 12 1000 1000 4,0K juil.  6 11:34 bonita-continuous-delivery_1.0.0
-rw-rw-r--  1 1000 1000 418M juil.  6 11:34 bonita-continuous-delivery_1.0.0.tar.gz

$ cat ~/.boto
[Credentials]
aws_access_key_id = AKO9PHAI7YOSHAEMOHS6
aws_secret_access_key = aicheeChe8Koh4aeSh3quum4tah8cohku3Hi8Eir

$ ls -n ~/.ssh/bonita_us-west-2.pem
-rw------- 1 1000 1000 1692 jul. 6 11:36 ~/.ssh/bonita_us-west-2.pem

$ docker run --rm -ti --hostname control_machine --name bcd-controller \
        -v ~/.boto:/home/bonita/.boto \
        -v ~/bonita-continuous-delivery_1.0.0:/home/bonita/bonita-continuous-delivery \
        -v ~/.ssh/bonita_us-west-2.pem:/home/bonita/.ssh/bonita_us-west-2.pem \
        bonitasoft/bcd-controller /bin/bash
bonita@control_machine:~$
bonita@control_machine:~$ cd bonita-continuous-delivery
bonita@control_machine:~/bonita-continuous-delivery$
</code></pre>
<h2>Use Bonita Continuous Delivery solution</h2>
<p>We provide a <a href="?page=cli" ng-click="contentCtrl.goTo($event, 'cli')">BCD Command Line Interface</a> (CLI) to execute Bonita Continuous Delivery commands.</p>
<p>The BCD CLI is directly available as a <code>bcd</code> command when using the <code>bonitasoft/bcd-controller</code> Docker image.</p>
<p>The <code>bcd</code> command must be launched from the <code>bonita-continuous-delivery</code> directory where Bonita Continuous Delivery Ansible playbooks are located.</p>
<p>You can call the <code>bcd</code> command with the <code>--help</code> option to get available options and commands:</p>
<pre><code>bonita@control_machine:~$
bonita@control_machine:~$ cd bonita-continuous-delivery
bonita@control_machine:~/bonita-continuous-delivery$ bcd --help
Usage: bcd [OPTIONS] COMMAND1 [ARGS]... [COMMAND2 [ARGS]...]...

  Bonita Continuous Delivery CLI.

Options:
  -s, --scenario PATH    YAML scenario file (required)
  -y, --yes              Execute action without confirmation prompt
  -v, --verbose          Enable Ansible verbose mode
  -e, --extra-vars TEXT  Extra vars for Ansible (multiple) - Variables are
                         passed using the key=value syntax.
  -h, --help             Show this help message

Commands:
  status     Show the platform status
  create     Create AWS instances
  deploy     Deploy Bonita stack
  undeploy   Undeploy Bonita stack
  destroy    Destroy AWS machines (EC2 instances)
</code></pre>
<!-- Generated on Wed Jan 31 2018 10:22:57 GMT+0100 (Paris, Madrid) -->